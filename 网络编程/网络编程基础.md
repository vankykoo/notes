# 网络编程

## 一、网络基础

###1）网络通信

①概念：两台设备之间通过网络实现数据传输

②网络通信：将数据通过网络从一台设备传到另一台设备

③java.net包下提供了一系列的类或接口，供程序员使用，完成网络通信。



###2）网络

[1]概念：两台或多台设备通过一定物理设备连接起来构成了网络。

[2]根据网络的覆盖范围不同，对网络进行分类：

①局域网：覆盖范围最小，仅仅覆盖一个教室或一个机房

②城域网：覆盖范围较大，可以覆盖一个城市

③广域网：覆盖范围最大，可以覆盖全国，甚至全球，万维网是广域网的代表。

###3）ip地址

①概念：用于唯一标识网络中的每台计算机/主机

②查看ip地址：ipconfig

③ip地址的表示形式：点分十进制   xx.xx.xx.xx

④每一个十进制数的范围：0~255

⑤ip地址的组成=网络地址+主机地址，比如：192.168.16.69

⑥IPv6是互联网工程任务组设计的用于替代IPv4的下一代IP协议。

⑦由于IPv4最大的问题在于网络地址资源有限，严重制约了互联网的应用和发展。IPv6的使用，不仅能解决网络地址资源数量的问题，而且也解决了多种接入设备连入互联网的障碍。

![img](https://pic-1317004580.cos.ap-guangzhou.myqcloud.com/%E7%AC%94%E8%AE%B0/11/22/IPv4%E5%9C%B0%E5%9D%80%E5%88%86%E7%B1%BB.png)

###4）域名

①概念：将ip地址映射成域名。如www.baidu.com是一个域名。

②需要通过【IP+端口】来访问一个服务



###5）端口号

①概念：用于标识计算机上某个特定的网络程序。

②表示形式：以整数形式，端口范围：0-65536（两个字节）

③0-1024已经被占用，如：ssh 22，ftp 21，smtp 25，http 80

④常见的网络程序端口号：tomcat 8080，mysql 3306，oracle 1521，sqlserver 1433。



###6）网络通信协议

**[1]协议（tcp/ip）**：TCP/IP是传输控制协议/因特网互联协议的简写，又叫网络通讯协议，这个协议是Internet最基本的协议、Internet国际互联网络的基础，简单地说，就是由网络层的IP协议和传输层的TCP协议组成的。

**[2]TCP协议：传输控制协议**

①使用TCP协议前，须先建立TCP连接，形成传输数据通道。

②传输前，采用”三次握手“方式，是可靠的。

③TCP协议进行通信的两个应用进程：客户端、服务端。

④在连接中可进行大数据量的传输。

⑤传输完毕，需释放已建立的连接，效率低。

**[3]UDP协议：用户数据协议**

①将数据、源、目的封装成数据包，不需要建立连接。

②每个数据包的大小限制在64K内，不适合传输大量数据。

③因无需连接，所有是不可靠的。

④发送数据结束时无需释放资源（因为不是面向连接的），速度快。

![](https://pic-1317004580.cos.ap-guangzhou.myqcloud.com/%E7%AC%94%E8%AE%B0/11/22/%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE.png)

## 二、InetAddress

1）相关方法：

①【getLocalHost】：获取InetAddress对象

②【getByName】：根据指定主机名/域名获取ip地址对象。

③【getHostName】：获取InetAddress对象的主机名。

④【getHostAddress】：获取InetAddress对象的地址。

## 三、Socket

![](https://uploadfiles.nowcoder.com/images/20180316/8955099_1521189690989_0BB28C2A1ECCC47EC020E89E8A554BBC)

###1）基本介绍

①套接字（Socket）开发网络应用程序被广泛采用，以至于成为事实上的标准。

②通信的两端都要有Socket，是两台机器间通信的端点。

③网络通信其实就是Socket间的通信。

④Socket允许程序把网络连接当成一个流，数据在两个Socket间通过IO传输。

⑤一般主动发起通信的应用程序属客户端，等待通信请求的为服务端。



### 附：

>  **ServerSocket**(int port) 是服务端绑定port端口，调accept()监听等待客户端连接，它返回一个连接队列中的一个socket。
>
>  **Socket**(InetAddress address ,int port)是创建客户端连接主机的socket流，其中InetAddress是用来记录主机的类，port指定端口。
>
>  ![](https://uploadfiles.nowcoder.com/images/20161017/4552908_1476667093647_1915F9C678C8EA2DBDCFB50383935889)

> 服务器端通过调用`ServerSocket`对象的`accept()`方法来创建与客户端通信的`Socket`对象。当一个客户端连接到服务器时，服务器端的`accept()`方法会返回一个新的`Socket`实例，该实例用于与客户端进行通信。
>
> 客户端则通过创建一个新的`Socket`实例并连接到服务器来建立连接。例如，客户端可以这样创建一个`Socket`实例并连接到服务器：
>
> ```java
> Socket socket = new Socket(serverAddress, serverPort);
> ```
>
> 其中，`serverAddress`是服务器的IP地址，`serverPort`是服务器监听的端口号。

> Socket套接字就是源Ip地址，目标IP地址，源端口号和目标端口号的组合 .
>
>   服务器端：ServerSocket提供的实例 
>
>   ServerSocket server= new ServerSocket(端口号) 
>
>   客户端：Socket提供的实例 
>
>   Socket soc=new Socket(ip地址，端口号) 

## 四、TCP编程

###1）基本介绍

①基于客户端---服务端的网络通信。

②底层使用的是TCP/IP协议。

③应用场景举例：客户端发送数据，服务端接受并显示控制台。

④基于Socket的TCP编程

![](https://pic-1317004580.cos.ap-guangzhou.myqcloud.com/%E7%AC%94%E8%AE%B0/11/22/TCP%E7%BC%96%E7%A8%8B.png)

###2）TCP字节流编程：

[1]主机/客户端：发起连接

思路：	①连接服务器（ip，端口）

​		②连接上后，生成Socket，写入socket.getOutputStream()，记得结束标记

​		③写入socket.getIntputStream()

​		④通过输出流，写入数据到数据通道

​		⑤关闭流

[2]主机/服务端：接收请求连接（监听）

思路：	①在本机的9999端口监听，等待连接

​		②当没有客户端连接9999端口时，程序会阻塞，等待连接

​		③通过socket.getInputStream()读取客户端写入到数据通道的数据，显示。

​		④写入socket.getOutputStream()，记得结束标记

​		⑤关闭流



###3）netstat指令

[1]使用方法

①【netstat -an】：可以查看当前主机网络情况，包括端口监听情况和网络连接情况

②【netstat -an|more】：可以分页显示

③【win+r】：显示出dos控制台

[2]说明

①Listening表示某个端口在监听

②如果有一个外部程序（客户端）连接到该端口，就会显示一条连接信息。

③可以输入【ctrl+c】退出指令



※当客户端连接到服务端后，实际上客户端也是通过一个端口和服务端进行通讯的，这个端口时TCP/IP来分配的，是随机的。

## 五、UDP编程

1）基本介绍

①类DatagramPacket[数据包/数据报]实现了基于UDP协议网络程序。

②UDP数据报通过数据报套接字DatagramSocket发送和接收，系统不保证UDP数据报一定能够安全送到目的地，也不能确定什么时候可以抵达。

③DatagramPacket对象封装了UDP数据报，在数据报中包含了发送端的IP地址和端口号以及接收端的IP地址和端口号。

④UDP协议中每个数据报都给出了完整的地址信息，因此无须建立发送方和接收方的连接。



2）基本流程

①核心的两个类/对象DatagramSocket与DatagramPacket。

②建立发送端，接收端（没有服务端和客户端概念）

③发送数据前，建立数据包/报DatagramPacket对象。

④调用DatagramSocket的发送、接收方法。

⑤关闭DatagramSocket。





## 补充

### 1）管道

> 对于管道，有下面这几种类型：
>
> ①**普通管道（PIPE）**：通常有两种限制，一是单工，即只能单向传输；二是血缘，即常用于父子进程间（或有血缘关系的进程间）。
>
> ②**流管道（s_pipe）**：去除了上述的第一种限制，实现了双向传输。
>
> ③**命名管道（name_pipe）**：去除了上述的第二种限制，实现了无血缘关系的不同进程间通信。
>
>  **显然，要求是对于不同的服务器之间的通信，是要要求全双工形式的，而管道只能是半双工，虽然可以双向，但是同一时间只能有一个方向传输，**





























