# Linux


## 一、基础介绍

### 1）Linux主要发行版

Ubuntu（乌班图）、RedHat（红帽）、CentOS、Debain（蝶变）、Fedora、SuSE、OpenSUSE



### 2）VM和Linux的关系

![](https://github.com/vankykoo/image/blob/main/027.png?raw=true)



### 3）网络连接的三种方式

![](https://github.com/vankykoo/image/blob/main/028.png?raw=true)





### 4）虚拟机克隆

如果已经安装了一台Linux操作系统，没有必要重新安装，只需要进行克隆即可。

* 方式一：直接拷贝一份安装好的虚拟机文件，在vm中打开就行。
* 方式二：使用VMware的克隆操作，克隆时需要先关闭linux系统。





### 5）虚拟机快照

如果你在使用虚拟机系统的时候（比如Linux），你想回到原先的某一个状态，也就是说你担心可能有些误操作造成系统异常，需要回到原先某个正常运行的状态，VMware也提供了这样的功能，就叫快照管理。



### 6）虚拟机的迁移和删除

虚拟系统的本质就是文件。因此虚拟系统的迁移很方便，可以把安装好的虚拟系统这个**文件夹整体拷贝或者剪切**到其他位置使用。

删除时，可以**用VMware进行移除，再点击菜单->从磁盘删除**即可；或者**直接手动删除虚拟系统对应的文件夹**即可。



### 7）vmtools

#### 1、安装

![](https://github.com/vankykoo/image/blob/main/029.png?raw=true)



#### 2、设置共享文件夹

![](https://github.com/vankykoo/image/blob/main/030.png?raw=true)

※注意：

* windows和centos可以共享文件，但是在实际开发中，文件的上传下载是需要使用远程方式完成的。



### 8）目录结构

linux的文件系统是采用级层式的树状目录结构，在此结构中的最上层是根目录“/”，然后在此目录下再创建其他的目录。

![](https://github.com/vankykoo/image/blob/main/031.png?raw=true)

1. /bin【常用】(/usr/bin、/usr/local/bin)：是Binary的缩写，这个目录存放着最经常用的命令。
2. /sbin（/usr/sbin、/usr/local/sbin）：s就是Super User的意思，这里存放的是系统管理员使用的系统管理程序。
3. /home【常用】：存放普通用户的主目录，在Linux中每个用户都有一个自己的目录，一般该目录名是以用户的账号命名。
4. /root【常用】：该目录为系统管理员，也称作超级权限者的用户主目录。
5. /lib：系统开机所需要最基本的动态连接共享库，其作用类似于Windows里的DLL文件。几乎所有的应用程序都需要用到这些共享库。
6. /lost+found：这个目录一般情况下是空的，当系统非法关机后，这里就存放了一些文件。
7. /etc【常用】：所有的系统管理所需要的配置文件和子目录，比如安装mysql数据库，my.conf
8. /usr【常用】：这是一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下，类似于windows下的program files目录。
9. /boot【常用】：存放的是启动Linux是使用的一些核心文件，包括一些连接文件以及镜像文件。
10. /proc【不能动】：这个目录是一个虚拟的目录，它是系统内存的映射，访问这个目录来获取系统信息。
11. /srv【不能动】：service的缩写，该目录存放一些服务启动之后需要提取的数据。
12. /sys【不能动】：这是Linux2.6内核的一个很大的编号，该目录下安装了2.6内核中新出现的一个文件系统 sysfs
13. /tmp：这个目录是用来存放一些临时文件的。
14. /dev：类似于windows的设备管理器，把所有的硬件用文件的形式存储。
15. /media【常用】：linux系统会自动识别一些设备，例如U盘，光驱等等，当识别后，linux会把识别的设备挂载到这个目录下。
16. /mnt【常用】：系统提供该目录是为了让用户临时挂载别的文件系统的，我们可以将外部的存储挂载在/mnt/上，然后进入该目录就可以查看里面的内容了。
17. /opt：这是给主机额外安装软件所存放的目录，如安装ORACLE数据库就可以放到该目录下，默认为空。
18. /usr/local【常用】：这是另一个给主机额外安装软件所安装的目录，一般是通过编译源码方式安装的程序。
19. /var【常用】：这个目录下存放着在不断扩充着的对象，习惯将经常被修改的目录放在这个目录下，包括各种日志文件。
20. /selinux[security-enhanced linux]：SELinux是一种安全子系统，它能控制程序只能访问特定文件，有三种工作模式，可以自行设置。





### 9)Xshell和Xftp

![](https://github.com/vankykoo/image/blob/main/032.png?raw=true)



![](https://github.com/vankykoo/image/blob/main/033.png?raw=true)



![](https://github.com/vankykoo/image/blob/main/034.png?raw=true)



### 10）vi和vim的基本介绍

Linux系统会内置vi文本编辑器。

Vim具有程序编辑的能力，可以看做是Vi的增强版本，可以主动的以字体颜色辨别语法的正确性，方便程序设计，代码补完、编译及错误跳转等方便程序的功能特别丰富。

####1、vi和vim常用的三种模式

* 正常模式

  以vim打开一个档案就直接进入一般模式（默认模式），在这个模式中，可以使用【上下左右】按键来移动光标，可以使用【删除字符】或【删除整行】来处理档案内容，也可以使用【复制粘贴】来处理文件数据。

* 插入模式

  按下i,I,o,O,a,A,r,R等任何一个字母之后才会进入编辑模式，一般来说按i即可。

* 命令行模式

  在这个模式中，可以提供相关指令，完成读取、存盘、替换、离开vim、显示行号等的动作则是在此模式中达成的。



#### 2、vi和vim各个模式的切换图

![](https://github.com/vankykoo/image/blob/main/035.png?raw=true)



####3、常用快捷键

1. <u>在一般模式下</u>，**拷贝当前行** `yy` ，**拷贝当前行的向下的5行**  `5yy` ，并**粘贴**（输入 `p` ）。
2. <u>在一般模式下</u>，**删除当前行** `dd`，**删除当前行向下的5行** `5dd`，
3. **在文件中查找某个单词**，<u>命令行</u>下输入`/关键字`，回车 查找，输入`n`就是**查找下一个**。
4. **设置文件的行号**，<u>命令行</u>下 `:set nu` 和 **取消文件行号** `:set nonu`
5. <u>在一般模式下</u>，使用快捷键**到文档的最末行**`G`和**最首行**`gg`
6. <u>在一般模式下</u>，**撤销操作**为`u`
7. <u>在一般模式下</u>，**将光标移动到20行**---->先输入`20`，在输入 `shift + g`

![](https://github.com/vankykoo/image/blob/main/036.png?raw=true)





### 11）关机&重启命令

####1、基本介绍

* `shuntdown -h now` ：立即关机
* `shutdown -h 1` ：1分钟后关机
* `shutdown -r now` ：现在重新启动计算机
* `halt` ： 关机
* `reboot`：重新启动计算机
* `sync`：把内存的数据同步到磁盘中



#### 2、注意细节

* 不管是重启系统还是关闭系统，首先要运行`sync`命令，把内存的数据同步到磁盘中
* 目前的shutdown/reboot/halt等命令均已经在关机前进行了sync。



### 12）用户的登录和注销

#### 1、介绍

* 登陆时尽量少用root账号登录，因为它是系统管理员，最大的权限，避免操作失误。可以利用普通用户登录，登陆后再用“`su - 用户名`”命令来切换成系统管理员身份。
* 在提示符下输入`logout`即可注销用户。



#### 2、使用细节

* `logout` 注销指令在图形运行级别无效，在运行级别3下有效。





### 13）用户管理

#### 1、基本介绍

Linux系统是一个多用户多任务的操作系统，任何一个要使用系统资源的用户，都必须先向系统管理员申请一个账号，然后以这个账号的身份进入系统。



#### 2、添加用户

* 基本语法：`useradd 用户名`
* 细节说明：
  * 当创建用户成功后，会自动的创建和用户同名的家目录	/home/用户名
  * 也可以通过 `useradd -d 指定目录  用户名`  ，给新创建的用户指定家目录。



#### 3、指定/修改密码

* 基本语法：`passwd 用户名`



#### 4、删除用户

* 基本语法：`userdel 用户名`
* 案例
  * 删除用户，但是保留家目录：`userdel 用户名`
  * 删除用户及用户主目录：`userdel -r 用户名`
* 一般情况下，建议保留家目录。



#### 5、查询用户

* 基本语法：`id 用户名`
* ※当用户不存在时，返回无此用户。



#### 6、切换用户

* 介绍：在操作linux中，如果当前用户的权限不够，可以通过`su - 用户名`，切换到高权限用户，比如root。
* 基本语法：`su - 用户名`
* 细节说明：
  * 当权限高的用户切换到权限低的用户，不需要输入密码，反之需要。
  * 当需要返回到原来用户时，使用`exit/logout`指令。



#### 7、查看当前用户

* 基本语法：`who am i`



#### 8、用户组

* 介绍
  * 类似于角色，系统可以对有共性/权限的多个用户进行统一的管理。
* 新增组
  * 指令：`groupadd 组名`
* 删除组
  * 指令：`groupdel 组名`
* 增加用户时直接加上组
  * 指令：`useradd -g 用户组 用户名`
* 修改用户的组
  * 指令：`usermod -g 用户组 用户名`



#### 9、用户和组相关文件

* `vim /etc/passwd 文件`
  * 用户（user）的配置文件，记录用户的各种信息。
  * 每行的含义：**用户名：口令：用户标识号：组标识号：注释性描述：主目录：登录shell**
* `vim /etc/shadow 文件`
  * 口令配置文件
  * 每行的含义：**登录名：加密口令：最后一次修改时间：最小时间间隔：最大时间间隔：警告时间：不活动时间：失效时间：标志**
* `vim /etc/group 文件`
  * 组（group）的配置文件，记录linux包含的组的信息。
  * 每行含义：**组名：口令：组标识号：组内用户列表**





## 二、实用指令

### 1）指定运行级别

* 基本介绍
  * 0：关机
  * 1：单用户【找回丢失密码】
  * 2：多用户状态没有网络服务
  * **3：多用户状态有网络服务**
  * 4：系统未使用保留给用户
  * **5：图形界面**
  * 6：系统重启
* 指令：`init [0123456]`
  * 通过init来切换不同的运行级别
* centos7中
  * **multi-user.target**：运行级别3
  * **graphical.target**：运行级别5
  * 指令：**systemctl set-default TARGET.target**
    * 用来设置默认运行级别
    * 例如设置默认运行级别为3：`systemctl set-default multi-user.target`



### 2）找回root密码



### 3）帮助指令

* **man 获得帮助信息**
  * 基本语法：`man [命令或配置文件]` 
  * 功能：获得帮助信息
  * 案例：查看ls命令的帮助信息 `man ls`
  * 在linux下，隐藏文件是以 `.` 开头的。而且选项可以组合实用。
* **help 指令**
  * 基本语法：help 命令
  * 功能：获得shell内置命令的帮助信息



### 4）文件目录类

* **pwd 指令**
  * 基本语法：`pwd` 
  * 功能：显示当前工作目录的绝对路径
* **ls 指令**
  * 基本语法：`ls [选项]` 【目录或是文件】
  * 常用选项：
    * `-a` ：显示当前目录所有的文件和目录，包括隐藏的。
    * `-l` ：以列表的方式显示信息。
* **cd 指令**
  * 基本语法：`cd [参数]` 
  * 功能：切换到指定目录
  * `cd ~` 或者 `cd` ：回到自己的家目录
  * `cd ..` ：回到当前目录的上一级目录。



### 5）mkdir指令

* 功能：**用于创建目录**
* 基本语法：`mkdir 要创建的目录` 
  * `-p` ：创建多级目录



### 6）remdir指令

* 功能：**删除空目录**
* 基本语法：`rmdir 要删除的空目录`
* 如果要删除非空目录，需要使用 `rm -rf 要删除的目录`



### 7）touch指令

* 功能：**创建空文件**
* 基本语法：`touch 文件名称`



### 8）cp指令

* 功能：**拷贝文件到指定目录**
* 基本语法：`cp [source]  [dest]`
  * `-r`：递归复制整个文件夹
  * 例子：`cp -r /home/bbb /opt`   【将/home/bbb文件夹拷贝到/opt目录】



### 9）rm指令

* 功能：**移除文件或目录**
* 基本语法：`rm` 要删除的文件或目录
  * `-r` ：递归删除整个文件夹
  * `-f` ：强制删除（不提示）
  * 例子：递归删除整个文件夹（不提示） `rm -rf /home/bbb`




### 10）mv指令

* 功能：移动文件和目录或重命名
* `mv oldNameFile newNameFile`
  * 功能：当两个文件在同一个文件夹下时，重命名
* `mv /temp/movefile /targetFolder`
  * 功能：当两个文件不在同一个文件夹下时，移动文件。
* `mv cat.txt /home/pig.txt`
  * 功能：移动并重命名



### 11）cat指令

* 基本语法：`cat 要查看的文件`
* 功能：查看文件内容，【不能修改文件，为了浏览方便，一般会带上管道命令 `| more`】。
* `-n` ：显示行号
  * 例子：`cat -n /etc/profile | more`





### 12）more指令

more指令时一个基于vi编辑器的文本过滤器，它**以全屏幕的方式按页显示文本文件的内容**。more指令中内置了若干快捷键。

![](https://github.com/vankykoo/image/blob/main/037.png?raw=true)



### 13）less指令

less指令用来分屏查看文件内容，它的功能与more指令类似，但是比more指令更加强大，支持各种显示终端。less指令在显示文件内容时，并不是一次将整个文件加载之后才显示，而是**根据显示需要加载内容，对于显示大型文件具有较高的效率。**

* 基本语法：`less 要查看的文件`

* 快捷键

  ![](https://github.com/vankykoo/image/blob/main/038.png?raw=true)



### 14）echo指令

* 基本语法：`echo 输出内容`
* 功能：输出内容到控制台。



### 15）head指令

功能：用于显示文件的开头部分内容，默认情况下head指令显示文件的前10行内容。

* 基本语法
  * `head 文件` ：查看文件头10行内容。
  * `head -n 5 文件`：查看文件头10行内容，5可以是任意行数



### 16）tail指令

功能：用于输出文件中尾部的内容，默认情况下tail指令显示文件的前10行内容。

* 基本语法：
  * `tail 文件` ：查看文件尾部10行
  * `tail -n 5 文件`：查看文件尾部5行
  * `tail -f 文件` ：实时追踪该文档的所有更新。



### 17）> 指令和 >> 指令

* `>`  ：输出重定向
* `>>` ：输出追加
* 基本语法：
  * `ls -l > 文件`：列表的内容写入文件中（覆盖）
  * `ls -al >> 文件` ：列表的内容追加到文件的末尾
  * `cat 文件1 > 文件2`：将文件1的内容覆盖到文件2
  * `echo "内容" >> 文件` ：将内容追加到文件末尾。



### 18）ln指令

* 介绍：软链接也成为符号链接，类似于Windows里的快捷方式，主要存放了连接其他文件的路径。【当我们使用pwd指令查看目录时，仍然看到的是软链接所在的目录】
* 基本语法：
  * `ln -s 原本文件或目录 软链接名` ：给源文件创建一个软链接
    * 例子：`ln -s /root /home/myroot`：在/home目录下创建一个软链接myroot，连接到/root目录。
  * `rm 软链接名`：删除软链接



### 19）history指令

* 功能：查看已经执行过的历史命令，也可以执行历史指令。
* 基本语法：
  * 用法一：`history` ：显示所有的历史命令
  * 用法二：`hostory 行数` ：显示最近使用过的10个指令。
  * 用法三：`!5` ： 执行历史编号为5的指令。



### 20）date指令

* 基本语法：
  * `date`：显示当前时间
  * `date +%Y` ：显示当前年份
  * `date +%m` ：显示当前月份
  * `date +%d` ：显示当前是哪一天
  * `date "+%Y- %m-%d %H:%M:%S"`：显示年月日时分秒
* 设置日期：
  * `date -s 字符串时间`
  * 例子：date -s "2020-11-03 20:02:10"



### 21）cal指令

* 语法：
  * cal ：显示当前月的日历
  * cal 2020：显示2020年一整年的日历



### 22）find指令

* 功能：从指定目录向下递归地遍历其各个子目录，将满足条件的文件或者目录显示在终端。

* 基本语法：`find 搜索范围 查找内容`

  * 查找内容说明：

    ![](https://github.com/vankykoo/image/blob/main/039.png?raw=true)

  * 查找/home下hello.txt文件：`find /home -name hello.txt`

  * 查找/opt下，用户名称为nobody的文件：`find /opt -user nobody`

  * 查找整个linux系统下大于200M的文件：（+n 大于，-n小于，n等于，单位有k,M,G）

    `find / -size +200M`

### 23）locate指令

locate指令**可以快速定位文件路径**，locate指令利用事先建立的系统中所有文件名称及路径的locate数据库实现快速定位给定的文件，locate指令无需遍历整个文件系统，查询速度较快。为了保证查询结果的准确度，管理员必须定期更新locate时刻。

* 基本语法
  * `locate 搜索文件`
* 说明：由于locate指令基于数据库进行查询，所以第一次运行前，必须使用updatedb指令创建locate数据库。



※which指令：可以查看某个指令在哪个目录下，比如：`which ls`



### 24）grep指令和管道符号 |

* 介绍
  * `grep`：**过滤查找**
  * `|` ：管道符，表示将前一个命令的处理结果输出传递给后面的命令处理。
* **基本语法**：`grep 查找内容 源文件` ：在源文件中查找内容。
  * `-n` ：显示匹配行及行号。
  * `-i` ：忽略字母大小写。
* 例子：在hello.txt文件中查找yes所在行并且显示行号。
  * 写法一：`cat /home/hello.txt | grep "yes"`
  * 写法二：`grep -n "yes" /home/hello.txt`



### 25）解压/压缩指令

* **gzip/gunzip指令**

  * gzip用于压缩文件，gunzip用于解压
  * 基本语法：
    * `gzip 文件` ：压缩文件，只能将文件压缩为*.gz文件
    * `gunzip 文件名.gz`：解压缩文件

* **zip/unzip指令**

  * zip 用于压缩文件； unzip用于解压文件。

  * 基本语法：

    * `zip [选项] xxx.zip 压缩的内容` ：将要压缩的内容压缩为xxx.zip文件
    * `unzip [选项] xxx.zip` ：解压缩文件

  * zip常用选项：

    * `-r` ：递归压缩，即压缩目录

  * unzip常用选项：

    * `-d 目录` ： 指定解压后文件的存放目录

  * 例子：

    * 将/home下的所有文件/文件夹压缩成myhome.zip

      `zip -r myhome.zip /home/`

    * 将myhome.zip解压到 /opt/tmp目录下

      `unzip -d /opt/tmp /home/myhome.zip`

* tar指令

  * tar是打包指令，最后打包后的文件是.tar.gz的文件

  * 基本语法：tar [选项] xxx.tar.gz 打包的内容：将打包内容压缩成xxx.tar.gz文件

  * 选项：

    ![](https://github.com/vankykoo/image/blob/main/040.png?raw=true)

  * 例子：

    * 压缩多个文件，将/home/pig.txt 和/home/cat.txt压缩成 pc.tar.gz

      tar -zcvf pc.tar.gz /home/pig.txt /home/cat.txt

    * 将/home的文件夹压缩成 myhome.tar.gz

      tar -zcvf myhome.tar.gz /home/

    * 将pc.tar.gz解压到当前目录

      tar -zxvf pc.tar.gz

    * 将myhome.tar.gz 解压到/opt/tmp2目录下

      tar -zxvf /home/myhome.tar.gz -C /opt/tmp2



## 三、组管理和权限管理

###1）介绍

在linux中的每个用户都必须属于一个组，不能独立于组外。在linux中每个文件有所有者、所在组、其它组的概念。



### 2）文件/目录所有者

一般为文件的创建者，即谁创建了该文件，就自然的成为该文件的所有者。

* 查看文件的所有者：`ls -ahl`
* 修改文件的所有者：`chown 用户名 文件名`



### 3）文件/目录 所在组

* 当某个用户创建了一个文件后，这个文件的所在组就是该用户所在的组。
  * 查看文件/目录的所在组：`ls -ahl`
  * 修改文件所在的组：`chgrp 组名 文件名`
  * 例子：使用root用户创建文件orange.txt，看看当前这个文件属于哪个组，然后将这个文件所在组修改到fruit组。
    * `groupadd fruit`
    * `touch orange.txt`
    * `charp fruit orange.txt`
* **其它组：**除文件的所有者和所在组的用户外，系统的其它用户都是文件的其它组。



### 4）改变用户所在组

* 在添加用户时，可以指定将该用户添加到哪个组中，同样的用root的管理权限可以改变某个用户所在的组。

* 改变用户所在的组

  * `usermod -g 新组名 用户名`

  * `usermod -d 目录名 用户名`：改变该用户登录的初始目录。

    ※：用户需要有进入到新目录的权限。



### 5）权限的基本介绍

`ls -l` 中显示的内容如下：`drwxrw-r--. 15 vankykoo vankykoo 4096 9月  13 20:28 vankykoo`

* 0-9位说明：
  * 第0位是文件类型：
    * `-` 是普通文件
    * `d`是目录
    * `c`是字符设备文件，鼠标键盘
    * `b`是块设备，比如硬盘
    * `l`是链接文件
  * 第1-3位确定**所有者（该文件的所有者）拥有该文件的权限**。-----User
  * 第4-6位确定**所属组（同用户组的）拥有该文件的权限**，---Group
  * 第7-9位确定**其他用户拥有该文件的权限**，----Other
* 其他说明
  * `15` ：文件：硬连接数或 目录：子目录数
  * `vankykoo` ：用户
  * `vankykoo` ：组
  * `4096`：文件大小（字节），如果是文件夹，显示4096字节
  * `9月  13 20:28` ：最后修改日期
  * `vankykoo`：文件名



#### rwx权限

* rwx作用到文件时
  * r代表可读（read）：可以读取，查看
  * w代表可写（write）：可以修改，但是不代表可以删除该文件，删除一个文件的前提条件是对该文件所在的目录有写权限，才能删除该文件。
  * x代表可执行（execute）：可以被执行
* rwx作用到目录时
  * r代表可读（read）：可以读取，`ls`查看目录内容
  * w代表可写（write）：可以修改，对目录内创建+删除+重命名目录
  * x代表可执行（execute）：可以进入该目录



### 6）修改权限-chmod指令

* 基本说明：通过chmod指令，可以修改文件或者目录的权限。

* 第一种方式：**+、-、=变更权限**

  * u：所有者，g：所有组，o：其他人，a：所有人
  * 例子：
    *  `chmod u=rwx,g=rx,o=x 文件/目录名`
    *  `chmod o+w 文件/目录名`：给其他人添加w权限
    *  `chmod a-x 文件/目录名`：给所有人移去x权限

* 第二种方式：**通过数字变更权限**

  * r=4，w=2，x=1  		rwx=4+2+1=7

  * `chmod u=rwx,g=rx,o=x 文件目录名`

    相当于：`chmod 751 文件目录名`



### 7）修改文件所有者或所在组

* **修改文件所有者的基本语法介绍**

  * `chown newowner 文件/目录`： 改变所有者
  * `chown newowner:newgroup 文件/目录`： 改变所有者和所在组
  * `-R`：如果是目录，则使其下所有子文件或目录递归生效。

* **修改文件所在组**

  * `chgrp newgroup 文件/目录` ：改变所在组

  * 例子：将/home/test目录下所有的文件和目录的所在组都修改成shaolin

    `chgrp -R shaolin /home/test`





## 四、定时任务调度

### 1）crond任务调度

crontab 进行定时任务的设置

* 概述：

  * **任务调度：指系统在某个时间执行的特定的命令或程序。**
  * 任务调度的分类：
    * 系统工作：有效重要的工作必须周而复始地执行，如病毒扫描等
    * 个别用户工作：个别用户可能希望执行某些程序，比如对mysql数据库的备份。

* 基本语法 ： `crontab [选项]`

  * 常用选项：

    ![](https://github.com/vankykoo/image/blob/main/041.png?raw=true)

  * 例子：`*/1 * * * * ls -l /etc/ > /tmp/to.txt`

    意思是每小时的每分钟执行`ls -l /etc/ > /tmp/to.txt`命令

    ![](https://github.com/vankykoo/image/blob/main/042.png?raw=true)

  * 特殊符号说明：

    ![](https://github.com/vankykoo/image/blob/main/043.png?raw=true)

  * 示例：

    ![](https://github.com/vankykoo/image/blob/main/044.png?raw=true)



### 2）at定时任务

* 基本介绍

  * at命令是一次性定时计划任务，at的守护进程atd会以后套模式运行，检查作业队列来运行。
  * 默认情况下，atd守护进程**每60秒**检查作业队列，有作业时，会检查作业运行时间，如果时间与当前时间匹配，则运行此作业。
  * at命令是一次性定时计划任务，**执行完一个任务后不再执行此任务**了。
  * 在使用at命令的时候，一定要保证atd进程的启动，可以用`ps -ef | grep atd`来检测atd是否运行。

* atd命令格式：`at [选项] \[时间]`

  * `ctrl + D` 结束at命令的输入

  * at常用选项：

    ![](https://github.com/vankykoo/image/blob/main/045.png?raw=true)

  * at时间定义

    ![](https://github.com/vankykoo/image/blob/main/046.png?raw=true)






## 五、磁盘分区机制

### 1）Linux分区原理介绍

* Linux无论有几个分区，分给哪一目录使用，它归根结底就只有一个根目录，一个独立且唯一的文件结果，Linux中每个分区都是用来组成整个文件系统的一部分。
* Linux采用了一种叫“载入”的处理方法，它的整个文件系统中包含了一整套的文件和目录，且将一个分区和一个目录联系起来，这时要载入的一个分区将使它的存储空间在一个目录下获得。



### 2）硬盘说明

Linux硬盘分IDE硬盘和SCSI硬盘，目前基本上是SCSI硬盘。

![](https://github.com/vankykoo/image/blob/main/047.png?raw=true)



※命令：lsblk 或者 lsblk -f



### 3）挂载的案例

需求：增加一块硬盘

#### 1、虚拟机添加硬盘

在【虚拟机】菜单的设置中，添加硬盘，重启设备。

![](https://github.com/vankykoo/image/blob/main/048.png?raw=true)



#### 2、分区

分区命令：`fdisk /dev/sdb`

开始对/sdb分区

* 常见分区命令
  * `m`	显示命令列表
  * `p`      显示磁盘分区
  * `n`：新增分区
  * `d`：删除分区
  * `w`：写入并退出

说明：开始分区后输入n，新增分区，然后选择p，分区类型为主分区，两次回车默认剩余全部空间，最后输入w写入分区并退出，若不保存退出输入q。



#### 3、格式化

格式化命令： `mkfs -t ext4 /dev/sdb1`

其中ext4是分区类型



#### 4、挂载

**挂载**：将一个分区与一个目录联系起来。

命令：`mount 设备名称 挂载目录`

​	`umount 设备名称/挂载目录`

注意：**用命令行挂载，重启后会失效。**



#### 5、设置可以自动挂载

通过修改`/etc/fstab`实现自动挂载。

添加完成后执行 `mount -a`即刻生效。



> 在计算机系统中，挂载是一个重要的概念。挂载通常是指将一个设备（如硬盘、U盘、CD-ROM等）或文件系统关联到一个已存在的目录上，这样就可以通过访问这个目录来访问该设备或文件系统中的数据。
>
> 在Linux系统中，除了根文件系统，其他所有文件系统都需要先挂载到根文件系统中的某个目录后才能访问。所谓的根文件系统就是系统启动时安装的第一个文件系统，它也是内核映像所在的文件系统。而挂载到某个目录的那个目录就被称为挂载点。
>
> 例如，当你插入U盘后，系统自动分配给它一个盘符（如I:），这其实就是挂载的过程。当你安全弹出U盘时，其实就是在执行卸载（unmount）操作。
>
> 在Linux下，如果你插入了新硬盘，分了新磁盘区sdb1，你可以使用
>
> `mount /dev/sdb1 ~/Share/`命令，把新硬盘的区sdb1挂载到工作目录的~/Share/文件夹下，之后访问这个~/Share/文件夹就相当于访问这个硬盘2的sdb1分区了。
>
> 总的来说，挂载就是把设备放在一个目录下，让系统知道怎么管理这个设备里的文件，了解这个存储设备的可读写特性之类的过程。



### 4）磁盘情况查询

#### 1、查询系统整体磁盘使用情况

基本语法：`df -h`



#### 2、查询指定目录的磁盘占用情况

基本语法 ：`du -h`

* 常用选项
  * `-s` ：指定目录占用大小汇总
  * `-h` ：带计量单位
  * `-a` ：含文件
  * `--max-depth=1` ：子目录深度
  * `-c` ：列出明细的同时，增加汇总值



### 3、实用指令

* 统计/opt文件夹下文件的个数

  `ls -l /opt | grep "^-" | wc -l`

  * "^-"：正则表达式（以-开头的表示文件）
  * wc ：统计数量

* 统计/opt文件夹下目录的个数

  `ls -l /opt | grep "^d" | wc -l`

  * "^d"：以d开头的为目录

* 统计/opt文件夹下文件的个数，包括子文件夹里的

  `ls -lR /opt | grep "^-" | wc -l`

  * R ：递归

* 以树状显示目录结构：`tree 目录`





## 六、网络配置

### 1）NAT网络配置原理图

![](https://github.com/vankykoo/image/blob/main/049.png?raw=true)

> **NAT（Network Address Translator，网络地址转换）**是一种用于在本地网络中使用私有地址，在连接互联网时转而使用全局 IP 地址的技术。NAT实际上是为解决 IPv4地址短缺而开发的技术。
>
> **NAT的工作机制**如下：
>
> - 网络被分为私网和公网两个部分，NAT网关设置在私网到公网的路由出口位置，双向流量必须都要经过NAT网关。
> - 网络访问只能先由私网侧发起，公网无法主动访问私网主机。
> - NAT 路由器在两个访问方向上完成两次地址的转换或翻译，出方向做源信息替换，入方向做目的信息替换。
> - NAT 路由器的存在对通信双方是保持透明的。
> - NAT 路由器为了实现双向翻译的功能，需要维护一张关联表，把会话的信息保存下来。
>
> **NAT有3种类型：静态NAT，动态NAT，端口复用NAPT**：
>
> - **静态NAT**：内部本地地址一对一转换成内部全局地址，相当内部本地的每一台PC都绑定了一个全局地址。一般用于在内网中对外提供服务的服务器。
> - **动态NAT**：在内部本地地址转换的时候，在地址池中选择一个空闲的，没有正在被使用的地址，来进行转换。
> - **端口复用NAPT**：面对私网内部数量庞大的主机，如果NAT只进行IP地址的简单替换，就会产生一个问题：当有多个内部主机去访问同一个服务器时，从返回的信息不足以区分响应应该转发到哪个内部主机。此时，需要 NAT 设备根据传输层信息或其他上层协议去区分不同的会话，并且可能要对上层协议的标识进行转换，比如 TCP 或 UDP 端口号。
>
> 总体来说，NAT技术可以节省合法的公有 IP 地址、避免重新编址、隐藏内部地址以增加网络安全性等。但同时也存在一些缺点和局限性，例如无法从 NAT 的外部向内部服务器建立连接、转换表的生成和转换操作都会产生一定的开销等。尽管如此，NAT仍然是目前解决IPv4地址短缺问题的重要过渡技术之一。



### 2）常用指令

* Windows查看网络配置：`ipconfig`
* Linux查看网络配置：`ifconfig`
* 测试主机之间网络连通性：`ping 目的主机`



### 3）网络配置

* 说明：直接修改配置文件来指定IP，并可以连接到外网。

* 编辑：`vim /etc/sysconfig/network-scripts/ifcfg-ens33`

  ![](https://github.com/vankykoo/image/blob/main/050.png?raw=true)

* 然后使用指令 `service network restart`或者`reboot`重置



### 4）设置主机名和hosts映射

#### 1、Windows

在C:\Windows\System32\drivers\etc\hosts中添加映射即可。![](https://github.com/vankykoo/image/blob/main/051.png?raw=true)



#### 2、Linux

在/etc/hosts文件中指定

![](https://github.com/vankykoo/image/blob/main/052.png?raw=true)



### 5）主机名解析过程

####1、Hosts、DNS

* Hosts：Hosts是一个没有扩展名的系统文件，其作用就是**将一些常用的网址域名与其对应的IP地址建立一个关联“数据库”**。当用户在浏览器中输入一个需要登录的网址时，系统会首先自动从Hosts文件中寻找对应的IP地址，一旦找到，系统会立即打开对应网页，如果没有找到，则系统会再将网址提交DNS域名解析服务器进行IP地址的解析。

  简单来说，**hosts是一个浏览网页控制文件，可以从源头上控制DSN指向，在浏览网页中起着举足轻重的作用**。在Windows系统中，Hosts文件位于`C:\Windows\System32\drivers\etc`路径下。修改Hosts文件可以达到屏蔽不健康网站、加快域名解析、方便局域网用户等多种作用。总的来说，Hosts文件是一个非常重要的网络配置文件，它在我们日常上网过程中起着至关重要的作用。





* DNS：域名系统，Domain Name System的缩写，是互联网上作为域名和IP地址相互映射的一个分布式数据库。

  > DNS，全称为Domain Name System，即域名系统，是一种用于将域名和IP地址相互映射的分布式数据库系统。在Internet上，每个设备都被分配了一个唯一的IP地址，但IP地址并不容易被人们记忆，因此就有了域名的概念。比如我们经常访问的百度网站的IP地址是180.101.49.11，但是我们只需要输入“www.baidu.com”就可以访问了。我们可以把DNS理解成转换域名与IP地址之间的“翻译器”。
  >
  > DNS的主要作用是将主机名解析为IP地址的过程，完成了从域名到主机识别ip地址之间的转换。DNS是一个分布式、分层次的主机名管理架构，通过配置DNS服务器地址，主机不需要知道对应的ip地址就能通过主机名的形式访问互联网。
  >
  > DNS利用类似倒状树的目录结构将主机名的管理分配在不同层级的DNS服务器当中，经过分层管理，每一级DNS服务器负责部分域名信息，这就减轻了DNS服务器的负载，同时也方便记录的更新同步。
  >
  > DNS是一个网络服务，因此就有对应的端口，其端口号为53号。 DNS查询的时候，是以udp这个比较快速的数据传输协议来查询的，但万一没有方法查询到完整的信息时，就会再次以tcp这个协定来重新查询。
  >
  > 总体来说，DNS技术可以使用户更方便地访问互联网，并提高网络通信效率。



#### 2、用户浏览百度流程

用户浏览www.baidu.com发生了如下过程：

* 浏览器先检查浏览器缓存中有没有该域名解析IP地址，有就先调用整个IP完成解析；如果没有，就检查DNS解析器缓存，如果有直接返回IP完成解析。这两个缓存可以理解为本地解析器缓存。
* 一般来说，当电脑第一次成功访问某一网站后，在一定时间内，浏览器或操作系统会缓存他的IP地址（DNS解析记录）可以在cmd窗口中输入如下指令：
  * ipconfig /displaydns：dns域名解析缓存
  * ipconfig /flushdns：手动清理dns缓存
* 如果本地解析器缓存没有找到对应映射，检查系统中hosts文件中有没有配置对应的域名IP映射，如果有，则完成解析并返回。
* 如果本地DNS解析器缓存和hosts文件中均没有找到对应的IP，则到域名服务DNS进行解析域。

![](https://github.com/vankykoo/image/blob/main/053.png?raw=true)

> **Linux系统的开机过程**可以分为以下几个阶段：
>
> 1. **BIOS上电自检 (POST)**：当你按下电源按钮，计算机硬件会自动加载BIOS，读取BIOS内相关硬件信息及进行硬件系统的自检，随后根据BIOS配置找到第一个有引导程序的设备。
> 2. **引导装载程序（GRUB2）**：硬盘上第0磁道第一个扇区被称为MBR，即主引导记录，大小是512字节，存放了预启动信息、分区表信息。系统找到BIOS所指定的硬盘的MBR后，就会将其复制到物理内存中，被复制到物理内存的内容就是Boot Loader（lilo或者grub）。
> 3. **加载内核**：Boot Loader 就是在操作系统内核运行之前运行的一段小程序。通过这段小程序，我们可以初始化硬件设备、建立内存空间的映射图，从而将系统的软硬件环境带到一个合适的状态，以便为最终调用操作系统内核做好一切准备。
> 4. **运行 init**：内核加载完毕后，运行用户空间内第一个应用程序就是/sbin/init，然后读取/etc/inttab文件，依据文件配置设定系统运行等级。
> 5. **系统初始化**：设定了运行级别后，Linux系统执行/etc/rc.d/rc.sysinit系统初始化脚本程序。初始化包括：设置主机名、设置欢迎信息、激活Udex和seliux、挂载/etc/fstab文件中定义的所有文件系统、检测根文件系统、设置系统时钟、根据/etc/sysctl.conf文件来设置内核参数、激活LVM及软RAID设备、激活swap设备、加载额外设备的驱动程序、执行清理操作。
> 6. **建立终端**：根据运行级别的不同，系统会运行rc0.d到rc6.d中的相应的脚本程序，来完成相应的初始化工作和启动相应的服务。
> 7. **用户登录系统**：最后，Linux 就会启动终端机或者是 X Window 来等待使用者登陆。
>
> 这个过程涉及到底层硬件设备的初始化、操作系统内核的加载和启动、系统服务和应用程序的启动等多个步骤。每个步骤都有其特定的目标和任务，共同构成了Linux系统从开机到可供用户使用的完整过程。
